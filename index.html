<!DOCTYPE html>
<html lang="it">
<head>
	<title>Progetto DB</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>

	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">

	<script type="text/javascript">
		function getData() {
			$(document).ready(function () {
				$.ajax({
					type: "GET",
					dataType: "json",
					cache: false,
					url: '/example',
					success: (data) => {
						$('#res').html(JSON.stringify(data, null, 2));
					},
					error: function (e) {
						console.log("error:", e);
					}
				})
			})
		}
		function getTable(selection) {
			let index = selection.value;
			$.ajax({
				url: '/table/' + index,
				data: JSON.stringify(form),
				success: (data) => {
					displayTable(data, index);
				},
				error: (e) => {

				}
			});
		}
		function displayTable(table) {
			let db_table = document.createElement('table');
			let thead = document.createElement('thead');
			db_table.appendChild(
				thead.innerHTML(
					getHeader(table)
				)
			);
			let tbody = document.createElement('tbody');
			table.forEach((element) => {
                let tr = document.createElement(tr);
				Object.keys(element).forEach((key) => {
					tr.innerHTML(tr.innerHTML() + '<td>' + element[key] + '</td>');	
				});
				tbody.appendChild(tr);
			});
			db_table.appendChild(tbody);
		}
		function getHeader() {
			let header = '';
			Object.keys(table[0]).forEach((key) => {
				header += '<th>' + key + '</th>';
			});
			let tr = document.createElement('tr');
			return tr.innerHTML(header);
        }
	</script>
</head>

	<body>
		<div id="commands" style="width:100vw; height:20vh; border: outset 5px;">
			<label for="tables">Tabella da visualizzare</label>
			<select id="tables" onchange="getTable(this)">
				<option value="produttore">Produttore</option>
				<option value="fornitore">Fornitore</option>
				<option value="azienda_trasporti">Azienda di Trasporti</option>
				<option value="prodotto">Prodotto</option>
				<option value="package">Package</option>
				<option value="procedura_lavorazione">Procedura di Lavorazione</option>
				<option value="materia_prima">Materia Prima</option>
				<option value="composizione">Composizione</option>
				<option value="fertilizzante">Fertilizzante</option>
				<option value="pesticida">Pesticida</option>
				<option value="mangime">Mangime</option>
				<option value="utilizzo_fertilizzante">Utilizzo Fertilizzante</option>
				<option value="alimentazione">Alimentazione</option>
			</select>
			<br />
			<button>
				Aggiungi
			</button>
		</div>
		<div id="display">

		</div>
	</body>
</html>
